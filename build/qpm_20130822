#!/bin/sh
#         QPM       0.1.0     9904      15404     
##############################################################################
#
# $Id: qbuild $
#
# This script is used to build QPKGs.
#
##############################################################################

IFS=" "

#---
# Default Configs
#---
QPM_QPKG_VER=""

QPM_DIR_ICONS="icon"
QPM_DIR_ARM="arm"
QPM_DIR_X86="x86"
QPM_DIR_SHARE="share"
QPM_DIR_WEB="web"
QPM_DIR_BIN="bin"
QPM_DIR_BUILD="build"

QPM_QPKG_CONFIGS="qpkg.cfg"
QPM_QPKG_SERVICE="service.sh"
QPM_QPKG_SERVICE_ID=101
QPM_QPKG_DATA="data.tar.gz"
QPM_QPKG_SCRIPT="script.sh"
QPM_QPKG_INSTALL="install.sh"
QPM_QPKG_UNINSTALL="uninstall.sh"
QPM_QPKG_WEB_CONFIG="apache-qpkg-${QPKG_NAME}.conf"
QPM_QPKG_BIN_LOG=".bin_log"
QPM_QPKG_CORE="/sbin/qpkg"
QPM_QPKG_TEMPLATE="template"

QPM_QPKG_NAME_MAX=20
QPM_QPKG_VER_MAX=10


#---
# Message
#---

# Error messages
err_msg(){
  echo "[ERROR] $1" 1>&1
  echo "[x] 任務失敗"
  rm -rf build.$$ &>/dev/null
  rm -rf tmp.$$ &>/dev/null
  exit 0
}

warn_msg(){
  echo "[WARN] $1" 1>&1
}

msg(){
  echo "$1" 1>&1
}

debug_msg(){
  #msg "$1" $DEBUG
  return 0
}

#---
# Library
#---

edit_config(){
  local field="$1"
  local value="$2"
  local qpkg_cfg="${3:-$QPM_QPKG_CONFIGS}"
  if [ -n "$field" ] && [ -n "$value" ] && [ -f "$qpkg_cfg" ]; then
    local space=$(awk 'BEGIN{i=0;while(i++<'$(expr 48 - ${#field} - ${#value} - 1)')printf " "}')
    value=$(echo ${value} | sed 's/\//\\\//g')
    sed "s/${field}=[^#]*/${field}=${value}${space}/" $qpkg_cfg > $qpkg_cfg.$$
    rm -f $qpkg_cfg
    mv -f $qpkg_cfg.$$ $qpkg_cfg
  else
    return 1
  fi
}

#---
# Main
#---

# Help messages
help(){
  cat <<EOF
Usage: $(/usr/bin/basename $0) [options] [--create NAME]
Options:
  --create, -c NAME       建立一個package目錄
  -?, -h, --help          顯示操作訊息
  -V, -ver, --version     列出qbuild的版本資訊.
EOF
  exit 0
}

# Create directory with template build environment
create_qpkg(){

  [ -n "$1" ] || err_msg "internal error: create called with no argument"
  local qpkg_name="$1"

  [ -d "$qpkg_name" ] && err_msg "$(pwd)/${qpkg_name} 已經存在"

  echo "建立 $qpkg_name 目錄..."
  mkdir -m 755 -p "${qpkg_name}" || err_msg "${qpkg_name}: 主目錄建立失敗"
  local qpm_len=$(sed -n "2s/ */ /p" ${0} | awk -F ' ' '{print $5}')
  dd if=${0} bs=${qpm_len} skip=1 | tar -xz -C ${qpkg_name} || exit 1
  mv ${qpkg_name}/${QPM_QPKG_TEMPLATE}/* ${qpkg_name}
  rm -rf ${qpkg_name}/${QPM_QPKG_TEMPLATE}

  echo "初始化 QPKG設定檔..."

  local configs_path="${qpkg_name}/${QPM_QPKG_CONFIGS}"

  edit_config "QPKG_NAME" \"${qpkg_name}\" ${configs_path}
  edit_config "QPKG_DISPLAY_NAME" \"${qpkg_name}\" ${configs_path}
  edit_config "QPKG_AUTHOR" \"$(/usr/bin/whoami)\" ${configs_path}
  edit_config "#QPKG_DIR_ICONS" \"${QPM_DIR_ICONS}\" ${configs_path}
  edit_config "#QPKG_DIR_ARM" \"${QPM_DIR_ARM}\" ${configs_path}
  edit_config "#QPKG_DIR_X86" \"${QPM_DIR_X86}\" ${configs_path}
  edit_config "#QPKG_DIR_WEB" \"${QPM_DIR_WEB}\" ${configs_path}
  edit_config "#QPKG_DIR_BIN" \"${QPM_DIR_BIN}\" ${configs_path}
  edit_config "#QPKG_DIR_SHARE" \"${QPM_DIR_SHARE}\" ${configs_path}

  echo "[v] package初始化完成"
}

pad_field(){
  [ -n "$1" ] || err_msg "internal error: pad_field called with no argument"

  local field="$1"
  local field_val=
  eval "field_val=\$$field"
  local pad_len=$(expr ${2:-10} - ${#field_val})

  [ $pad_len -ge 0 ] || err_msg "the length of $field_val must be less than or equal to ${2:-10}"
  while [ $pad_len -gt 0 ]
  do
    field_val="$field_val "
    pad_len=$(expr $pad_len - 1)
  done
  eval $field=\""$field_val"\"
}

build_qpkg(){
  # Fetch configs
  msg "取得QPKG設定值..."
  source $QPM_QPKG_CONFIGS

  QPM_QPKG_VER="${QPKG_VER_MAJOR}.${QPKG_VER_MINOR}.${QPKG_VER_BUILD}"
  QPM_QPKG_VER=${QPM_QPKG_VER:-0.1.0}

  # Check
  msg "檢查編譯環境..."
  [ -n "$QPKG_AUTHOR" ] || err_msg "$QPM_QPKG_CONFIGS: QPKG_AUTHOR 必須設定值"
  [ -n "$QPKG_NAME" ] || err_msg "$QPM_QPKG_CONFIGS: QPKG_NAME 必須設定值"
  [ ${#QPKG_NAME} -gt ${QPM_QPKG_NAME_MAX} ] && err_msg "QPKG的NAME不可以超過${QPM_QPKG_NAME_MAX}個字元"
  [ ${#QPM_QPKG_VER} -gt ${QPM_QPKG_VER_MAX} ] && err_msg "QPKG的VERSION不可以超過${QPM_QPKG_VER_MAX}個字元"

  # Build
  msg "編譯QPKG..."

  rm -rf build.$$
  mkdir -m 755 -p build.$$ || err_msg "無法建立暫存目錄 ${build.$$}"
  mkdir -m 755 -p tmp.$$ || err_msg "無法建立暫存目錄 ${tmp.$$}"

  local script_len=$(sed -n "2s/ */ /p" ${0} | awk -F ' ' '{print $4}')
  local qpm_len=$(sed -n "2s/ */ /p" ${0} | awk -F ' ' '{print $5}')
  qpm_len=$(expr ${qpm_len} - ${script_len})
  dd if=${0} bs=${script_len} skip=1 | tar -xz -C tmp.$$ || exit 1

  cp -afp ${QPM_QPKG_CONFIGS} "build.$$/${QPM_QPKG_CONFIGS}" || err_msg 找不到configs檔
  echo "\n" >> "build.$$/${QPM_QPKG_CONFIGS}"
  cat "tmp.$$/qpm_qpkg.cfg" >> "build.$$/${QPM_QPKG_CONFIGS}"
  edit_config "QPM_QPKG_VER" \"${QPM_QPKG_VER}\" "build.$$/${QPM_QPKG_CONFIGS}"

  local service_file="build.$$/${QPM_QPKG_SERVICE}"
  cat tmp.$$/qpm_service_start.sh > ${service_file}
  echo "\n" >> ${service_file}
  cat ${QPM_QPKG_SERVICE} >> ${service_file} || err_msg 找不到service檔
  echo "\n" >> ${service_file}
  cat tmp.$$/qpm_service_end.sh >> ${service_file}

  cp -af ${QPKG_DIR_ICONS:-${QPM_DIR_ICONS}} build.$$/${QPM_DIR_ICONS} || warn_msg 找不到icon目錄
  cp -af ${QPKG_DIR_ARM:-${QPM_DIR_ARM}} build.$$/${QPM_DIR_ARM} || warn_msg 找不到icon目錄
  cp -af ${QPKG_DIR_X86:-${QPM_DIR_X86}} build.$$/${QPM_DIR_X86} || warn_msg 找不到x86目錄
  cp -af ${QPKG_DIR_SHARE:-${QPM_DIR_SHARE}} build.$$/${QPM_DIR_SHARE} || warn_msg 找不到shared目錄

  cat tmp.$$/${QPM_QPKG_INSTALL} > "build.$$/${QPM_QPKG_INSTALL}"
  cat tmp.$$/${QPM_QPKG_UNINSTALL} > "build.$$/${QPM_QPKG_UNINSTALL}"

  tar -zcpf "tmp.$$/${QPM_QPKG_DATA}" -C "build.$$" ${QPM_QPKG_SERVICE} ${QPM_DIR_ICONS} ${QPM_DIR_ARM} ${QPM_DIR_X86} ${QPM_DIR_SHARE} ${QPM_QPKG_INSTALL} ${QPM_QPKG_UNINSTALL} ${QPM_QPKG_CONFIGS}
  rm -rf build.$$

  mkdir -m 755 -p ${QPM_DIR_BUILD} || err_msg "無法建立編譯目錄"

  local qpkg_file_name=${QPKG_FILE:-${QPKG_NAME}_${QPM_QPKG_VER}.qpkg}
  local qpkg_file_path=${QPM_DIR_BUILD}/${qpkg_file_name}
  rm -f "${qpkg_file_path}"
  touch "${qpkg_file_path}" || err_msg "建立package失敗 ${qpkg_file_path}"

  echo "\n#qpm#" >> tmp.$$/${QPM_QPKG_SCRIPT}
  local script_len=$(ls -l tmp.$$/${QPM_QPKG_SCRIPT} | awk '{ print $5 }')
  sed "s/EXTRACT_SCRIPT_LEN=000/EXTRACT_SCRIPT_LEN=${script_len}/" tmp.$$/$QPM_QPKG_SCRIPT > ${qpkg_file_path}

  #dd if=tmp.$$/$QPM_QPKG_DATA of="${QPM_QPKG_BUILD}/${qpkg_file_path}"
  cat tmp.$$/$QPM_QPKG_DATA >> ${qpkg_file_path}

  rm -rf tmp.$$

  ######
  # [MODEL(10)|RESERVED(40])|FW_VERSION(10)|NAME(20)|VERSION(10)|FLAG(10)]
  local enc_space=$(awk 'BEGIN{i=0;while(i++<60)printf " "}')
  local enc_flag="QNAPQPKG  "
  local enc_qpkg_name="${QPKG_NAME}$(awk 'BEGIN{i=0;while(i++<'$(expr 20 - ${#QPKG_NAME})')printf " "}')"
  local enc_qpkg_ver="${QPM_QPKG_VER}$(awk 'BEGIN{i=0;while(i++<'$(expr 10 - ${#QPM_QPKG_VER})')printf " "}')"
  printf "${enc_space}${enc_qpkg_name}${enc_qpkg_ver}${enc_flag}" >> ${qpkg_file_path}
  ######

  edit_config "QPKG_VER_BUILD" $(expr ${QPKG_VER_BUILD} + 1)

  echo "建立${qpkg_file_path}..."

  if [ -x "${QPM_QPKG_CORE}" ]; then
    echo "認證QPKG..."
    ${QPM_QPKG_CORE} --encrypt ${qpkg_file_path}
  else
    echo "傳送至${avg_host}認證QPKG..."
    local nas_qpkg="/share/Public/${qpkg_file_name}"
    scp ${qpkg_file_path} "admin@${avg_host}:${nas_qpkg}"
    ssh admin@${avg_host} "${QPM_QPKG_CORE} --encrypt ${nas_qpkg}" >/dev/null
    scp "admin@${avg_host}:${nas_qpkg}" ${qpkg_file_path}
  fi

  echo "[v] package編譯完成"

  if [ -n "${avg_upload}" ]; then
    echo "upload to ...${avg_upload}"
    scp ${qpkg_file_path} "${avg_upload}"
  fi
}

# Main
main(){
  while  [ $# -gt 0 ]
  do
    case $(echo "$1" | awk -F"=" '{ print $1 }') in
    --help|-h|-\?)  avg_help=TRUE ;;
    --version|-ver|-V) avg_version=TRUE ;;
    --create|-c) avg_qpkg_name="$2"
        [ -n "$avg_qpkg_name" ] || err_msg "--create, -c: 沒有package名稱"
        shift
        ;;
    --upload) avg_upload=$(echo "$1" | sed 's/--upload=//g') ;;
    --nas) avg_host=$(echo "$1" | sed 's/--nas=//g') ;;
    --push-key) avg_push_key=TRUE ;;
    esac
    shift
  done

  [ -n "$avg_version" ] && version
  [ -n "$avg_help" ] && help

  if [ -n "$avg_qpkg_name" ]; then
    [ ${#avg_qpkg_name} -gt ${QPM_QPKG_NAME_MAX} ] && err_msg "QPKG的NAME不可以超過${QPM_QPKG_NAME_MAX}個字元"

    create_qpkg "$avg_qpkg_name"
  elif [ -n "$avg_push_key" ]; then
    local id_rsa_client="$HOME/.ssh/id_rsa.pub"
    local id_rsa_server="\$HOME/.ssh/id_rsa_$(/usr/bin/whoami).pub"
    if [ ! -e "${id_rsa_client}" ]; then
      echo "系統將為您建立公開金鑰，請依照步驟按下[ENTER]鍵"
      sleep 3
      ssh-keygen -t rsa
    fi
    while [ -z "$avg_host" ]; do
      printf "請輸入要配置的NAS IP:"
      read avg_host
      echo "連線至${avg_host}..."
      ping -c 1 ${avg_host} &> /dev/null
      if [ $? -ne 0 ]; then
        avg_host=""
        printf "IP有誤，"
      fi
    done
    scp "${id_rsa_client}" "admin@${avg_host}:${id_rsa_server}"
    ssh "admin@${avg_host}" "cat ${id_rsa_server} >> .ssh/authorized_keys"
  else
    if [ ! -x "${QPM_QPKG_CORE}" ] && [ -z "$avg_host" ]; then
      while [ -z "$avg_host" ]; do
        printf "請輸入用來編譯的NAS IP:"
        read avg_host
        echo "檢測${avg_host}..."
        ping -c 1 ${avg_host} &> /dev/null
        if [ $? -ne 0 ]; then
          avg_host=""
          printf "IP有誤，"
        fi
      done
      echo "提醒您，可使用[--nas]參數輸入NAS IP"
    fi
    build_qpkg # 2>/dev/null
  fi
}

main "$@"
exit 1
#qpm#
 R <kwH_ѣIpl:ƻ`YVFH'ߪ~[O6ɹ9'FUեzCwB0ەRto̞i9,,KiH;x)}CdYQ?j<@a]!;+13dB4m2CujP({;sbEUZ=7(Nl|,Ζ|$_瓻 f[S=kNWlWt>ܶNaT\Ll֐$N_ԛP5ev}l&Ŵm+ٻRHnJ6ɔyd%OSx?V:KvcM\awLպpA_cBS<Y|\Gdt?(7`?+헶{#,dM&3tg.Кe_}'CAAlp<lnmJw;඀9Jr\rjah9 pggfMqӳs
%s0xM.dCǁlH.ju{ꥐq5r^NOx/kݫKr+^tpc}d 9a.8 
nu/_:=EA^{TW¬ 	+1+݂ʹZ@ӺBOQyV[sU>Y(`U7&OV41b{$
@$>ݾbm+Fvw~kZqj5:.No\ڱ7ubnNeɑx-R|Z95,\YM節|uի<j_c-ڭ`lu0}q!7wEZj0'ۿ5.FUC\NԱ]~qo3|mֹ1d}k7-ejԷ"t)+ER}:M界)vqZO2z48ku$xa46t8SEsq)̝8_</s'~
NS0bիޫ^].ƞ7/Q̺I|G~;v&XU	߮Tx߶"44(U#Z_ջPjv	>,9GY§E7hoڗ)/b 20l@WT V1e* =?ME*;:"(bl0r6	j\ߺYKLFģFT''E݁CgXߨU̒тUOP$J+WMYbfY<)N6>%: {[gB,R{_q]gbdwjCHeyG3bdM<?Y,)"r f*H#A3f(լ!(F!;OP!Csa&ѺoWS>u֪`> RU;3 ewQwHW@x9yU.g A9:A Ifܫl_f݅켬7wnvb}x'8yV"yvr,&#1U1@9Lg>fb)\;2{{h/Rd1ӪDxK5LqKdV0+#,GO!u'24wQ1(A^PF/
ɘk0oh1HW@ey?$	&/@jw!M#pY#yhhH<09mPuRmIwߣE8`ܤjtȿ">(Ty=..u@)2KpȪ4dB(͘X+V96 ̖h~C/*hlPshWle
]r`_%|Yy] !Orq|h-ߺߙd#>`ծZXX0_-ٮ_I7 ;Hf ܠ!q.;	H~"|!lKҝΧ437kfفGRZHz)L;<!r|\oeK^NbM\+O	V=U%-D&Ԁ\RA՜pAwk;)\#!-߆[X>d{SCEI(D?`OT՘&Kh#,
ZpQAjb]lnkB=)QQiD2>k!|$ ߊpMϮu2zF+A`ڲ\N\eQU/*9 sDCh۵K=nb&(ϧ. \.C.-)h[69Wz&R.[\
=g]Vֺ	:Kj>5fao s߃!݄. lA4+7yI>Ԉ7`f
'$"L0'?m/64vy.3M^x#svsN.(=DG>/J$3?7ˇ3I~J)[ʂ.SSBd+rZ>7IҘi̓eE$lK).T$*o*ga ɪ}eR@^	Έu뤌Je&6 Ղh`}*ώdV6[7{ѷc[0EF fS={=sR}MlCloEmu7'-bqBuIb_?JX4D =$cFCuϓQcHQ{ uwq+{}j\NLg4@zv;YwGh189wtQ(D8&/'wr-ҵYtEaDE"VI+D'OZ4ΐhP;cgAX!fy+>$Gf|j됝/N4ΐOLpLBͅ'U9>=jTj$er'T/wFC83TIƄeƔ{<Z&PeXLh&ʜVNMd $2#b%ޜXq	LG"7\TT*9Dז-L\*B!dY+?&9Oz7Nnqr+϶؞릹˫	1'ژ	k;,]ߙ:E8j"0xDtu:s:7WN]jMu	˟0m0&`ѕKQt	v9ԞBBF7i㴋i/E=*U?+翢S'!prf}T/1k'ޭ;|Ql:waH语@L&/5iJ׵8=ADao(tCn.i Hlڲ E@5]Xe4g˟?ʸRI4{C$1P*(C4U4IU8G#*A_e~"`(|4bJAU=YӞZ`tm-S5ΐ(i{Țh3$sk1NgLo\Fs~l=-J$-)FyQD<TDA#Ga2#P:@sf
Xie=_+2Őu1WefƐ˱=4#BQ}FUIm<fi½D18zv'\d7Kye22Lq&CEm7SZ󡢽unț[넑\TgC/g(]Hq=&4䈵@W[IpQCwmbV	#qNb&c^'Dt&cٟVK-|dУ5y"%n#ȆhK{F̚I*MKhGf
eGZ3Ѫ	NL(mVpb:#YMyH#oϠdȷlNC#䬼IvDA+N}& ֊#N`808X9Y~:眪25}p*
#&wcYy+ߛSL;_.ތaBY #)l+rM򖯟a]ž!'{NƿOaimƪ?7E)ߞ%i:ˮ%LdIm6Q$%
F\b~tKG֥wI%PK2bR[V#ZdK26^/ӦrdD#^c7D)K8
|%V	劵n#w q%䋈djUeҬGyB<]ϳmO>qdVQ!QkSYDGD#>,bxߏ !r00[9.gr|^zX|M~&	g Xӏ~T}RGla*Byj:.+o*[K;l*@O\$U9뼪{[P&g~dɺ6eLG֑RHbh0!P%:Pw̨y}-Ұ:^WⰷԬlBtB$e9<2˳$QQy)Pe"wKtskĚύ<?ji" Dt4sbz1K4kwiѳ-V1)BvRܼz1GܺO4Nn}΋-nH*elTQRm/'mF|.	1> J$|8譪kn\jh-;v_$ulLgNa	z3'eŨP)j;#]tIKx}ӨeuSd7F"ָf!=}$*
ȍչx_Ft5*~9ySxmՏߦ3ܠAa#o=?gAh?GlMn}(߄0RVs\s[]­Z~?`iTR^aL,4#>k,uôfY5~s%'C&wt#ODi&SIL_o4$A?:nB hE-Uu.?e	S?gl˶l˶l˶l˶l˶l˶l˶l˶l˶l˶l˶l˶l˶l	( x  
#qpm#
 R XTIְ	s&Inr 9%'9$,9(ArFI*A$'	$33vS֭޾u
7{';76_}$agsA8\ 0 qe	wW7<߰qms5Kb<~Kp[J9X8nNn9! H L@Jj m%PyϪ~ƟWy? bWwF||Kyxa0s ^>g_ :OgtWndg ! #k8;z9;Y;z٘[|v3qsw3qGr[|[R[@}A炃닂݅L@*(nԁ:Ny\ _q7Bg``=o	ƿT+vo}gq`] ^|m43EIQ6伆!Jm<ox'575Eŀ@.K	$r?ܥDEK	KM/.%¥Dؗt)2i/_>G^ /_=K	N3~1@	5	1O/ųt?.u/ĀuAz)I0`3qƀ? <<`\s~j3G}`X~jg'[+V3K37a e9i+ԋE$@ jh).f	Y5eyQ?bg+y+i!ҔT5R*DQV"#K?_첊!T?%!+/qa(2:A.G$Ԗ/{X_t/ҐIK+˃n3{Ԡ؈Ҩƻ_-JhȪ[Prvt 	YA*6.>ظPV<[lzxi@\IQRRVgs0G+Vʃ_fWRU){ZoŐTSWR6UVhjg5R#u5s[FW<nXyR=YU#Q݂NO:oswDUofϳ/UF$¤6/`RMFT}7MxLJ*Kl3o翫-3VW?7?7#d3q`sF53q Qќ^mPAjqc@;~HM]TU$*.{~HJ~) UKܶ7uj췏 K7._ؕU</ovw;Z[ټӯX'-\MӍ[E@=O?b_27ssp`O7Ca?_uߝs!?y  /x<  Xl$80`o/0`/ ~G l0`X?khGENNv.7k1;K~.. ~eW?j&/_E1~Zw:Ꞁؿ zo+}'
0xF.mF<0`?0`z1۰?0`ˀ]l:9Yk^_<`Nv!?B
1߶H?Oߩ ўѓ|g 0 `VkD[)	`8VF/?Mw& )a~Tvc=0 ;u)s?aOYg#,B5N]^JLDηy2lUQW3F9f{KnN5`Y2pW)ܰ"RYQ`H\-"!_9[l< `J{Lr2pYmдe|U'B'٧2<3OTcCLdGPjyF#+x?h'0lgLG3mpO~foTGK&#66H/`L>xSSc䲉+-p}敏sgG[-NzgA$~%I%m7ȊJyD]wҤs&vuBLl<M=}:k]|a?b@Cj%_|1S*[SҚ9CԨV	:6'_fz@d[:S8C
WpP-IPᝅ
g$=OsqCR?ÿrh= !}Aa1?W)P¡&AsefPZٙ!^/	l~e?#BµZR|<\VJ%Ҵ[ۗP׊ޕUG1G\34S$5vQ/==%XUj|!wf∱:%by5g<Qw|)|g^"ߌWX zufBy5!~{c$8a>.c4\:w5bJj8qq¨{1#8a?84uI"FwF4P\DG+oZȴ L1-Q[^\m>JD-sV^G75imQo[<xvTMN*h=Phѭkbdtv}Iq`R>_NԀ2ޖ9Z̪YpΫ9aT>u`ٍSg.EgZ}l<n;1e?=']aqPsUeNX8Q窾;mfUdFEWRi$Li$߳hJ0{a9D)GЛ3$Ř!gkd`f*Ք
ɭpg7X~3bZlf<&i}YRˉ S1xOYQKs;I*s4MMKс\d7AtR I^Fs| ۡTȻ9GESmg0}TVvUG^ox:,[2}9둈2	ا#-S,yvD:DX;&P*P4sQE@ou5<t&04/9S{(TʕN+G齚TB2 o6JnDJ
XCnPWeC@q̇ר}҄VΡpdp~)Xb-TT8f;ńpD)ρ]br3}W2]|lYdJ#YVnpXCSI#mr*?-hP%&D==Q!".W n҈ɵcmϏ9Tbt0 =bPpUMc	}U[(mǢwF;}5<!$,l|[ȗU$AQW-DShxsP)EC`U*JWp J<;d!S[c0)LϻJ9bS$NA\I喸\?K~%WҞd70iҀT8tUsNkR4HD Lg/pjF 	щCS|1_؅7"к }	~Z;hH 7xT1@E拱Ɍw|gU)k+{Ntz.NB~ g#8C :v>ߵ<;~Q.+I3ֹ4^QheN" " TeWg}k,>%jieڼk,L}}KB Ċ@[!ʂe%ﵛayH3媟U$eR"#:-4	<<_ͅL%Jsw_;ԗz_y{X1t\ס!/Vϡ@L=QhWBNNPYM2f݈gH
[bUSH0KsZW
hrJ`,iY[z<{I>=>{0unarϦt*| g/&d?/G|$i+oltͬ3nk|\pv2P\1]io1N~_BnOxE暴?y)ܽ]O}zFM.7X%swx>	:Xt(|ub$]n7ݳx19w 88m>/lUFtDm1k^@W/?)lCmQu]A^=V`@bVd R^8ԃmHUO?YVGU둢sa`MsHW6?~[c5r4JeNy0%"eҙI6X8ttj"hkTj>Z0/S[OACSvÉv+3aylek6Cuh޺uL'
h5{oXcs)r=U	|z0 Nxɝ\^pab),.f}:Iv\x4B骖нhE憱v䵬o/?(KU XZ2feHl p@nH<2*RxKN\kYffRmo5\[RCỻ<)c)J&#:5׻#ZnwL^`R]Y8`-"E8wsIlJ،vMygQ6-!{pM(	e=JCL!m	<H`wlu'7
Nv깔a	N/_MzlSkȿ­ UnKnvmX s,\Y4"Ru<՘zQ"q\P?|bG[ڏY!	`fhb&hl8w)NV6 "*jqS5N	8_{.Fut
@CvܚUj-lvzRO/?t(lߎ}+ CMAI≝D61Ih)^A^qk!@~x]QljNw2(5o_P:|US8SjYgh9Wby^zdؕ' TzcQ1f97Nȷf?QQk=yQRheԮF |3ۿ;C@4c|KSČ'z6ܬ2b8I<+#OV4Q/yl1eJ3
&9E#j% `D$`CO%x.P(<WOqrYNN]pLqꂃ]d3Sw1ߞ8T!95E!;BJq$D*_Pʓۖȅ𺹈ܛpH5KS>j@ʃG:xn/EBE
Ro&('kBc!I(m]dB":Èmƃ*A^,f/'f\wamNB>Ɵy-5>ك*+)P[,ͤ;zߒ|Bnƶ{W
hۙwe=Qo4dG4Uf44gK@jG@ȷ_&#p@#u嫷wIo07d@`ȀuDQEJ^Nla 1#ڳkx*;)aOc8%DLzBOhЪm)(50(A%S"o
"{{GK?U=fJNZܓf;#!.:JjOvi{]4;7 I;g;ws-?+Fј)4/"eA
iwBDD)_}U6`~ҁC[Ĕ3jv""~%NĜ:=pYRNYIEr1`?_oN!D9v߆ĳ
z6!u?^ӈͳ/$y9'7ս~wc? e!׸gKzgRsl]*[POT.@YzIhSO.ϥUP6	&&5[h"'B5ۤ}x`C!?F c?g w-	ǚ#2	=@%%/YYڮ絡0b񱖼,yib<qUe.cу5N|/'c-&ç&_30|i{Bഊ  v x(2?OzF_	9'݈VKPcH/P$jZpO辱~(UHx[3xGS
h,Qz&QgWr=cR{7	YE+D>~۹bt!<:'ˉY^ )"pl!̣B_bg,>ƒV48+PDw$%[^"7VIMD\q|4ә lY)cwQ.`>m}rW1~N+/+%Ip9:5YsYқbf}de>.XТm/b<kjI([
t&zI`,/G$pO&w.Bʗ>;Lwhqmlk7S28ЛPf_jn4if[1/vc.j^eObXm߇]QM)b/@`mh{4\KSh\"=nDAZթ?VǉҔ.Dix&+4bP[D,Z9 &S+c Nw	k7XV/~D>tFzAGǡ(ybO8!Ale|>DTIWhf1?yI_,20o9akR96^c:vͽ9a-sȋ*R~50];¦c@ʪXSxC7 $t=k:_zV8fp_0JnNR$ƱJJ#qX2.n<BN[rEowm J/vѢbO6z4'n '{4=̗OYq,"&XJUw%~\OsG24Fj@kˣ=Tj.HOaY\z/5r&ݼWOߠih($
	]U+cGk/u<^ޒG6 x)9Y-!B"YbWaFW^#ӂf'VlD~L0GtYvT^nNNa
Y8e^xu}9w dK!UNzHQk G3Ĵt!>j^F;ckmhG&grUZўl\'Bmnq2c7gj-p'n-I[F&EWM
qZYVwJDOqZG iD΂H!s$gK R}j)W^QR#Z{4iy7&F \212[H>|¥˸J@>{7:ٵ UļikO4cў!;Oj.8{աr" '`p6:=B`\OP wE(/Qa+vHzAkeP$;<H\DdڽJU^o6"zGάFHs'υ4nb~@4ŭF5MHmT{8M=eT2|pD5h$͌2.2^G%UFAdNjJA^|Y;r)Hst5Ox9h`&UN&[jeɶ8E1H6N	R062ަaQ jm	%9iNLvb׎8+lRց	!FA~S8=f7'Ax) AgRqK)wm'xtdйºvSRyTVTfifp obX(g0WkZs(W"BPp _)<Dc;G*&b;)N<hI[sȋZv$]BRAS(?Ic~y',_?`g6	7vʆ
|^B>rA-4	DڄϾ/Mig}la(cI2^[
X˖ c*8&lbeu	Dj/s1%*U$<a^ NڤW<$b8r/\K@9gޮ{P^lM yJG%U~IaOD`e0]Hw*mxzE$фS]4>I~'i(Zj5hmۛkLQѣ4ћ%_@윪>Z5Z&x+d"B&NW(vݳg<sow֊ХIprGG6txu܆ط;cuPSd@cDGG}Ί<|4p$fPGgN,eW;Ǡ44a]qPhg'ND' 1輢(l+eo`Ai,)(5zҜN3"m(|SHKE]58DsN(-ȿN
)?FgוTm"[*9`r#(LǒFJ!؉eFt}D38d{bWw:n|{72Vn|?0?ZS3"Q-8eZ5g\ S8@C3?>瘍̞Q{q8G#U9M0ڹX?<R3"Zyr&Iri,T&vFEkl.I:ps˽~b do{5T`O'M|D{>D^P+`U`$v.Ai$ǹ9e[{GCZsVj. B,t=ogL&M BH:R޺y-:n%9Ut҆-7 %%#^	qikUh(6zu W)eׅ%>;M<)dr`hs:e'}%\p<4`lP?qbeu!:2*Z:F1d ,Jk1pvژM-o=0>$nVDU2FL!=y+g6>&Zjk}]Gq{bnE,l};T{~$[y),4VQ)n6dM4@׼mH-hʉ8L 4VIͦju$^w9%,<kK<>pE)h#}0'RnWJ*p,)i>Y\P|m]C5f[~cKj=P:VmʹD(!_ݏ:ܣsǟˎޗ,*մltA{vC8zD,T&&?=%]@]CB:g(N X_Qe|hr&a^
o	?ŨMGDB
{ׄs&Or9b]!e#6<_sP|CEpo~R]¨Sd-Y-&Z[!NOB5+t[mЄ?:2| |t^NG7坨R*,I?M)FZnD/BmE"[!]Zy"{=nP0xc"[PXU,B|)7<?"%La+V#[1&@)=^y{"l9JMlf$8\:ܣ+!nRiM|zրY=	u`q)W/8ߥ0dyU~d=5G*AbvSKܶȳ'9NJ;94K:`AYAYlYHb2T؇9I4Ӳ#ɉRS#.ו2S:K֜qe:Ҩ/~i^wݐ2ҕRIN~MCwѭwVz'ʕlǮ?)$4ۚ>x [$NPӾ;443=<Ap{4 PٻȵLVmPE^<+|FbJk3;+IǷvLF2?ZUV-̺S"*SfKf7}(HK;'F|
aVXHFW<E4+Ifdu[F>5P浑v*bjb5jSA>ddFm䚹靽fg@,iZVO]	"VX稄3Ե:-өk#owD PSw{gKǾ.ަD0plh`{,PTpkx*AfA׿/1V|J*P*y*{FZ0{s_vw\
1\丈d߉A/?67ҜEqWJd$mQb<joG3ڹsȟdt5g1&tU{cw)6"$[cijXCS$X;ukGrFR5Lޡ+zXI/5,k]gߊy<??ߜuq][,?A@ӃC6q"[-7_5a*ᢴ1#Sȕ}/YSR(v?kq/8~y*L󺭗u+|$;p`h -RsH̃ŇsU@+"Q,W>̆*y B}::MD"ޥCc;Hs(mi}qԍ(u#<P&Wb4*:+Enh{7lw5T<ji%ÊGSy>?dg`HbI,Jf;Z#KӺHH+JjarTT0i&[գM~\]Ez,-seE TY܊ypMEA\Ȼ>~_rǔ>XʰiTy.UqKpկh#f~r>^u[6[%Vu>#j6c(B0rm|5ip-秉]X
ۀ;~rJxy]I(0NNIz6c/CfftcGJ5S8hHKɋ3xdʹXY)>Wʬ)DRf6ɱ>6P/co|_yV1K@]FXjveB  ỦI8(!I֬˜nB2*RyݵaBB5i>r+8)fm,$| ouZ&uL{Цn
宁P)EFh	^Jun)S`kk|҇ϞexbP!ځݬIO5l4HY%G219\dbh*c|QPˇ,P_tdѓGnCsJV;B%{I;vTet-'ITZArQ6!s	סɜOa[yjYSaK!Wc׹b:EƸEcaDmkX;]$]nzI5TAٝfIn$zσ1M(c*%qɩժUE򪁆ێHA7O$\i~g7Ƌ2ilE
m{&<61Հ2`RyF CS{u\@"FG$侚Wwů)<]X&bg_5Kty1L<EԹH#Iē0۹Q,TpцXhq.}$v{zAZ]	uI(Ty
 ǃAlN<T47U٤2& zePcՌ; 68+n,dE(+4n(bEH#w)[]>* :ڐ5Ճj<tf^{%E0AFR	g^5KbTrXzC3\KBVKQC"U6^%Ώl'jEuQ2#wI(fӦ##8IGf0<|v+_GMJkt=3ȣbӡ(HBJ	W`cw_nHSHH]QLCd^LY!ޕ
}ސL89LE`@Cm
wFgýy#}IFqH'|x֔
giwtTm!\8G*q^8fgDa?epN#yuD
T0/flM<5!*XUnJeL99+y.Xdk~pi$F=S\TdO
QL袖a)msQɷq!	=jGdhK E*-$
n:S;0
 \+-q\$fW0Wⓡ|B)#uj@JL콘S>	2q:/c\Ϥ-ɜ$/"b WV#+FvEἠ[Ty%ǥ/yYrB댒wZj=EƞnY'!h=7/lYfޗL{:,d6l[YQhhܠpU1:n$@>AB?7Sm@!2ݰap+4S6?!A(83p{[xM3	? iQWd*?o/hБ_̇6Nߞcu+QMl@4nh2, T6@IkiY9F2!3&f{n,E{T*{+`ϧU0`xf   